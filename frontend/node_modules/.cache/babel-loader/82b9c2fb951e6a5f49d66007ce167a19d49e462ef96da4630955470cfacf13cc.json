{"ast":null,"code":"import React,{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import'./AdminDashboard.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminDashboard(){const[enquiries,setEnquiries]=useState([]);const[blocks,setBlocks]=useState([]);const[grease,setGrease]=useState([]);const[bearings,setBearings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState('');const navigate=useNavigate();useEffect(()=>{const fetchEnquiries=async()=>{try{const response=await fetch('http://localhost:5000/api/contact');const data=await response.json();if(response.ok){setEnquiries(data);setLoading(false);}else{throw new Error(data.message||'Failed to fetch enquiries');}}catch(err){setError(err.message);setLoading(false);}};const fetchProducts=async()=>{try{const[blocksRes,greaseRes,bearingsRes]=await Promise.all([fetch('http://localhost:5000/api/blocks'),fetch('http://localhost:5000/api/grease'),fetch('http://localhost:5000/api/bearing')]);const[blocksData,greaseData,bearingsData]=await Promise.all([blocksRes.json(),greaseRes.json(),bearingsRes.json()]);setBlocks(blocksData);setGrease(greaseData);setBearings(bearingsData);}catch(err){console.error('Failed to fetch products:',err);}};fetchEnquiries();fetchProducts();},[]);const handleLogout=()=>{localStorage.clear();sessionStorage.clear();navigate('/');};const handleProductChange=(setState,items,id,field,value)=>{const updated=items.map(item=>item._id===id?{...item,[field]:value}:item);setState(updated);};const handleSave=async(item,type)=>{try{const response=await fetch(`http://localhost:5000/api/${type}/${item._id}`,{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify(item)});const result=await response.json();if(!response.ok)throw new Error(result.message||'Failed to update');alert(`${type} product updated successfully!`);}catch(err){alert(`Error updating ${type} product: `+err.message);}};const renderProducts=(title,products,setProducts,type)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:title}),products.map(item=>/*#__PURE__*/_jsxs(\"div\",{className:\"product-card\",children:[/*#__PURE__*/_jsx(\"input\",{value:item.name,onChange:e=>handleProductChange(setProducts,products,item._id,'name',e.target.value),placeholder:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{value:item.price,onChange:e=>handleProductChange(setProducts,products,item._id,'price',e.target.value),placeholder:\"Price\"}),/*#__PURE__*/_jsx(\"textarea\",{value:item.description,onChange:e=>handleProductChange(setProducts,products,item._id,'description',e.target.value),placeholder:\"Description\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSave(item,type),children:\"Save\"})]},item._id))]});return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Customer Enquiries\"}),/*#__PURE__*/_jsx(\"button\",{className:\"logout-button\",onClick:handleLogout,children:\"Logout\"})]}),loading&&/*#__PURE__*/_jsx(\"p\",{children:\"Loading enquiries...\"}),error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:error}),!loading&&enquiries.length===0&&/*#__PURE__*/_jsx(\"p\",{children:\"No enquiries found.\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"enquiry-list\",children:enquiries.map((enquiry,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"enquiry-card\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Name:\"}),\" \",enquiry.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",enquiry.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Message:\"}),\" \",enquiry.message]})]},index))}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Manage Products\"}),renderProducts('Block Products',blocks,setBlocks,'blocks'),renderProducts('Grease Products',grease,setGrease,'grease'),renderProducts('Bearing Products',bearings,setBearings,'bearing')]});}export default AdminDashboard;","map":{"version":3,"names":["React","useEffect","useState","useNavigate","jsx","_jsx","jsxs","_jsxs","AdminDashboard","enquiries","setEnquiries","blocks","setBlocks","grease","setGrease","bearings","setBearings","loading","setLoading","error","setError","navigate","fetchEnquiries","response","fetch","data","json","ok","Error","message","err","fetchProducts","blocksRes","greaseRes","bearingsRes","Promise","all","blocksData","greaseData","bearingsData","console","handleLogout","localStorage","clear","sessionStorage","handleProductChange","setState","items","id","field","value","updated","map","item","_id","handleSave","type","method","headers","body","JSON","stringify","result","alert","renderProducts","title","products","setProducts","children","className","name","onChange","e","target","placeholder","price","description","onClick","style","color","length","enquiry","index","email"],"sources":["C:/Users/Acer/Desktop/SE_REVIEW/SE_Group4/frontend/src/pages/AdminDashboard.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './AdminDashboard.css';\r\n\r\nfunction AdminDashboard() {\r\n    const [enquiries, setEnquiries] = useState([]);\r\n    const [blocks, setBlocks] = useState([]);\r\n    const [grease, setGrease] = useState([]);\r\n    const [bearings, setBearings] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState('');\r\n    const navigate = useNavigate();\r\n\r\n    useEffect(() => {\r\n        const fetchEnquiries = async () => {\r\n            try {\r\n                const response = await fetch('http://localhost:5000/api/contact');\r\n                const data = await response.json();\r\n                if (response.ok) {\r\n                    setEnquiries(data);\r\n                    setLoading(false);\r\n                } else {\r\n                    throw new Error(data.message || 'Failed to fetch enquiries');\r\n                }\r\n            } catch (err) {\r\n                setError(err.message);\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        const fetchProducts = async () => {\r\n            try {\r\n                const [blocksRes, greaseRes, bearingsRes] = await Promise.all([\r\n                    fetch('http://localhost:5000/api/blocks'),\r\n                    fetch('http://localhost:5000/api/grease'),\r\n                    fetch('http://localhost:5000/api/bearing'),\r\n                ]);\r\n                const [blocksData, greaseData, bearingsData] = await Promise.all([\r\n                    blocksRes.json(),\r\n                    greaseRes.json(),\r\n                    bearingsRes.json(),\r\n                ]);\r\n                setBlocks(blocksData);\r\n                setGrease(greaseData);\r\n                setBearings(bearingsData);\r\n            } catch (err) {\r\n                console.error('Failed to fetch products:', err);\r\n            }\r\n        };\r\n\r\n        fetchEnquiries();\r\n        fetchProducts();\r\n    }, []);\r\n\r\n    const handleLogout = () => {\r\n        localStorage.clear();\r\n        sessionStorage.clear();\r\n        navigate('/');\r\n    };\r\n\r\n    const handleProductChange = (setState, items, id, field, value) => {\r\n        const updated = items.map(item => item._id === id ? { ...item, [field]: value } : item);\r\n        setState(updated);\r\n    };\r\n\r\n    const handleSave = async (item, type) => {\r\n        try {\r\n            const response = await fetch(`http://localhost:5000/api/${type}/${item._id}`, {\r\n                method: 'PUT',\r\n                headers: { 'Content-Type': 'application/json' },\r\n                body: JSON.stringify(item),\r\n            });\r\n            const result = await response.json();\r\n            if (!response.ok) throw new Error(result.message || 'Failed to update');\r\n            alert(`${type} product updated successfully!`);\r\n        } catch (err) {\r\n            alert(`Error updating ${type} product: ` + err.message);\r\n        }\r\n    };\r\n\r\n    const renderProducts = (title, products, setProducts, type) => (\r\n        <div>\r\n            <h3>{title}</h3>\r\n            {products.map((item) => (\r\n                <div key={item._id} className=\"product-card\">\r\n                    <input\r\n                        value={item.name}\r\n                        onChange={e => handleProductChange(setProducts, products, item._id, 'name', e.target.value)}\r\n                        placeholder=\"Name\"\r\n                    />\r\n                    <input\r\n                        value={item.price}\r\n                        onChange={e => handleProductChange(setProducts, products, item._id, 'price', e.target.value)}\r\n                        placeholder=\"Price\"\r\n                    />\r\n                    <textarea\r\n                        value={item.description}\r\n                        onChange={e => handleProductChange(setProducts, products, item._id, 'description', e.target.value)}\r\n                        placeholder=\"Description\"\r\n                    />\r\n                    <button onClick={() => handleSave(item, type)}>Save</button>\r\n                </div>\r\n            ))}\r\n        </div>\r\n    );\r\n\r\n    return (\r\n        <div className=\"admin-container\">\r\n            <div className=\"dashboard-header\">\r\n                <h2>Customer Enquiries</h2>\r\n                <button className=\"logout-button\" onClick={handleLogout}>Logout</button>\r\n            </div>\r\n\r\n            {loading && <p>Loading enquiries...</p>}\r\n            {error && <p style={{ color: 'red' }}>{error}</p>}\r\n            {!loading && enquiries.length === 0 && <p>No enquiries found.</p>}\r\n\r\n            <ul className=\"enquiry-list\">\r\n                {enquiries.map((enquiry, index) => (\r\n                    <li key={index} className=\"enquiry-card\">\r\n                        <p><strong>Name:</strong> {enquiry.name}</p>\r\n                        <p><strong>Email:</strong> {enquiry.email}</p>\r\n                        <p><strong>Message:</strong> {enquiry.message}</p>\r\n                    </li>\r\n                ))}\r\n            </ul>\r\n\r\n            <hr />\r\n            <h2>Manage Products</h2>\r\n            {renderProducts('Block Products', blocks, setBlocks, 'blocks')}\r\n            {renderProducts('Grease Products', grease, setGrease, 'grease')}\r\n            {renderProducts('Bearing Products', bearings, setBearings, 'bearing')}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AdminDashboard;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}